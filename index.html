<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<link rel="icon" type="image/png" href="icon.png">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00f6ff">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NotifyMe Pro</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Orbitron:wght@500&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0b0f14;
  --card:rgba(255,255,255,0.08);
  --primary:#00f6ff;
  --secondary:#7cff6b;
  --danger:#ff4d4d;
  --text:#e6f1ff;
  --muted:#9aa4b2;
}

*{box-sizing:border-box}
*cursor{
  cursor: url(normal.cur),auto;
}
body{
  margin:0;
  font-family:Inter;
  background:var(--bg);
  color:var(--text);
  cursor:url(normal.cur),auto;
}

body::before{
  content:"";
  position:fixed;
  inset:0;
  background-image:radial-gradient(rgba(0,246,255,.15)1.2px,transparent 1px);
  background-size:32px 32px;
  animation:bg 25s linear infinite;
  z-index:-1
}

@keyframes bg{
  to{background-position:400px 0}
}

/* TOP APP BAR */
.topbar{
  position:fixed;
  top:0;
  left:0;
  right:0;
  height:64px;
  display:grid;
  grid-template-columns:64px 1fr 64px;
  align-items:center;
  background:linear-gradient(180deg, rgba(0,246,255,.15), rgba(11,15,20,.9));
  backdrop-filter:blur(14px);
  border-bottom:1px solid rgba(255,255,255,.12);
  z-index:2000;
}

/* APP TITLE */
.apptitle{
  font-family:Orbitron;
  font-size:1.2rem;
  color:var(--primary);
  margin:0;
  pointer-events:none;
}

/* HAMBURGER */
.hamburger{
  position:relative;
  left:16px;
  background:none;
  border:none;
  color:var(--primary);
  font-size:26px;
  cursor:url(select.cur),pointer;
}




/* LAYOUT */
.app{
  max-width:1200px;
  margin:auto;
  display:grid;
  grid-template-columns:260px 1fr;
  min-height:100vh;
  padding-top:70px;
}

aside{
  padding:20px;
  border-right:1px solid rgba(255,255,255,.1);
}

aside h1{
  font-family:Orbitron;
  color:var(--primary);
  margin-bottom:30px
}

aside div{
  padding:12px;
  border-radius:12px;
  color:var(--muted);
  cursor:url(select.cur),pointer;
}

aside div.active{
  background:rgba(0,246,255,.15);
  color:var(--primary)
}

main{
  padding:20px;
  overflow-y:auto
}

.card{
  background:linear-gradient(135deg,var(--card),transparent);
  border:1px solid rgba(255,255,255,.15);
  border-radius:18px;
  padding:18px;
  margin-bottom:18px;
  transition:.25s
}

.card:hover{transform:translateY(-3px)}

input,select,button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  outline:none;
  font-size:.9rem
}

input,select{
  background:rgba(255,255,255,.1);
  color:var(--text);
  color: white;
  margin-bottom:10px
}
option{
  background-color: rgba(245, 245, 245, 0.448);
  color: black;
  
}

button{
  background:linear-gradient(90deg,var(--primary),var(--secondary));
  font-weight:600;
  cursor:url(select.cur),pointer;
}

ul{list-style:none;padding:0;margin:0}

li{
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  padding:14px;
  border-radius:14px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
  cursor:url(select.cur),pointer;
}
/* Priority Tags */
.tag{
  padding:2px 4px;
  border-radius:999px;
  font-size:.7rem;
  font-weight:600;
}

.tag.High{background:#ff4d4d;color:#fff}
.tag.Medium{background:#ffb84d;color:#000}
.tag.Low{background:#4dff88;color:#000}

/* Complete button */
.complete-btn,del{
  border:none;
  background:rgba(0,255,255,.15);
  color:var(--primary);
  font-size:16px;
  padding:2px 5px;
  border-radius:8px;
  cursor:url(select.cur),pointer;
}

.complete-btn.done{
  background:rgba(0,255,255,.35);
}


li.done{text-decoration:line-through;opacity:.6}

.time{font-size:.75rem;color:var(--muted)}

.actions {margin-left:10px;cursor:url(select.cur),pointer;display:flex;flex-direction: row;gap:3px;}

.stats{display:flex;gap:12px}
.stats div{flex:1;text-align:center}

.focus{text-align:center}
.timer{font-size:2.8rem;font-family:Orbitron;margin:10px 0}
.progress{height:8px;background:rgba(255,255,255,.1);border-radius:10px;overflow:hidden}
.progress div{height:100%;width:0;background:linear-gradient(90deg,var(--primary),var(--secondary))}

/* MOBILE */
@media(max-width:900px){
  .app{grid-template-columns:1fr}

  aside{
    position:fixed;
    top:64px;
    left:-100%;
    width:260px;
    height:calc(100% - 64px);
    background:var(--bg);
    transition:.3s ease;
    z-index:1500;
  }

  aside.show{left:0}
}
</style>
</head>

<body>

  <header class="topbar">
    <button class="hamburger" onclick="toggleSidebar()">â˜°</button>
    <h2 class="apptitle">NotifyMe Pro</h2>
    <button style="font-size: smaller; padding: 2px 5px;"  onclick="enablePush()">Push Notifications</button>
  </header>
  

<div class="app">

<aside id="sidebar">
  <div class="active" onclick="showTab('tasks',this)">Tasks</div>
  <div onclick="showTab('focus',this)">Focus</div>
  <div onclick="showTab('profile',this)">Profile</div>
</aside>

<main>

<section id="tasks" class="tab">
  <div class="card">
    <input id="task" placeholder="New task">
    <input id="time" type="datetime-local">

    <select id="repeat">
      <option value="none">No Repeat</option>
      <option value="daily">Daily</option>
      <option value="weekly">Weekly</option>
    </select>

    <select id="priority">
      <option value="Low">Low Priority</option>
      <option value="Medium">Medium Priority</option>
      <option value="High">High Priority</option>
    </select>

    <button onclick="addTodo()">Add Task</button>
  </div>
  <div style="display:flex; gap:10px; margin-bottom:12px;">
    <button onclick="sortByPriority()">Sort by Priority</button>
    <button onclick="sortByTime()">Sort by Time</button>
    <button onclick="sortByPriorityThenTime()">Smart Sort</button>
  </div>
  
  <ul id="list"></ul>

  <div class="card stats">
    <div>Total<br><b id="total">0</b></div>
    <div>Completed<br><b id="done">0</b></div>
    <div>Pending<br><b id="pending">0</b></div>
  </div>
</section>

<section id="focus" class="tab" style="display:none">
  <div class="card focus">
    <h3>Focus Mode</h3>
    <div class="timer" id="timer">25:00</div>
    <div class="progress"><div id="bar"></div></div>
    <button onclick="startFocus()">Start</button>
    <button style="margin-top:8px" onclick="stopFocus()">Stop</button>
  </div>
</section>

<section id="profile" class="tab" style="display:none">
  <div class="card">
    <h3>Profile</h3>
    <p class="time">Offline-first â€¢ No login</p>
    <button onclick="resetAll()">Reset App</button>
  </div>
</section>


</main>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-messaging-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "BCI0fuf200mjg3WoRYzUvwtVUH4q1a9-9H6QpqQ_G26FZrkOTgzLPt__9wJTlgSW1ujUFVcu8HtePs0raW8nUBs",
  authDomain: "notifyme-pro-87f7f.firebaseapp.com",
  projectId: "notifyme-pro-87f7f",
  messagingSenderId: "159097240950",
  appId: "1:159097240950:web:87e2bfce2cd4ba7bdece57"
};

firebase.initializeApp(firebaseConfig);

const messaging = firebase.messaging();
</script>

<script>
if("Notification" in window){
  Notification.requestPermission();
}

let todos = JSON.parse(localStorage.getItem("todos") || "[]");
let focusInt, seconds = 1500, totalFocus = 1500;

function toggleSidebar(){
  document.getElementById("sidebar").classList.toggle("show");
}

function showTab(id, el){
  document.querySelectorAll(".tab").forEach(t=>t.style.display="none");
  document.getElementById(id).style.display="block";
  document.querySelectorAll("aside div").forEach(d=>d.classList.remove("active"));
  el.classList.add("active");
  document.getElementById("sidebar").classList.remove("show");
}

function save(){localStorage.setItem("todos",JSON.stringify(todos))}

function render(){
  list.innerHTML="";
  let completed = 0;

  todos.forEach((t,i)=>{
    if(t.done) completed++;

    const li = document.createElement("li");
    if(t.done) li.classList.add("done");

    li.innerHTML = `
      <div>
        <strong>${t.text}</strong>
        <span class="tag ${t.priority}">${t.priority}</span>
        <div class="time">${new Date(t.time).toLocaleString()}</div>
      </div>

      <div class="actions">
        <button class="complete-btn ${t.done ? 'done' : ''}"
          onclick="toggleComplete(${i})">âœ”</button>
        <button onclick="removeTodo(${i})" class="complete-btn">ðŸ—‘</button>
      </div>
    `;

    list.appendChild(li);
  });

  total.textContent = todos.length;
  done.textContent = completed;
  pending.textContent = todos.length - completed;
}

const priorityRank = {
  High: 1,
  Medium: 2,
  Low: 3
};
function sortByPriority(){
  todos.sort((a, b) => {
    return priorityRank[a.priority] - priorityRank[b.priority];
  });
  save();
  render();
}
function sortByTime(){
  todos.sort((a, b) => {
    return new Date(a.time) - new Date(b.time);
  });
  save();
  render();
}
function sortByPriorityThenTime(){
  todos.sort((a, b) => {
    const pDiff = priorityRank[a.priority] - priorityRank[b.priority];
    if (pDiff !== 0) return pDiff;
    return new Date(a.time) - new Date(b.time);
  });
  save();
  render();
}

function addTodo(){
  if(!task.value || !time.value) return;
  const t={text:task.value,time:time.value,priority:priority.value,done:false};
  todos.push(t);
  schedule(t);
  save();render();
  task.value="";time.value="";
}


function toggle(i){todos[i].done=!todos[i].done;save();render()}
function removeTodo(i){todos.splice(i,1);save();render()}
function resetAll(){if(confirm("Reset all data?")){todos=[];save();render()}}

function schedule(t){
  const delay=new Date(t.time)-new Date();
  if(delay>0){
    setTimeout(()=>notify(t),delay);
  }
}

function notify(t){
  if(Notification.permission==="granted"){
    navigator.serviceWorker.ready.then(reg=>{
      reg.showNotification("Reminder",{body:t.text,icon:"icon.png"});
    });
  }
}

function startFocus(){
  clearInterval(focusInt);
  seconds=1500;totalFocus=1500;
  focusInt=setInterval(()=>{
    seconds--;
    timer.textContent=Math.floor(seconds/60)+":"+String(seconds%60).padStart(2,"0");
    bar.style.width=((totalFocus-seconds)/totalFocus*100)+"%";
    if(seconds<=0){
      clearInterval(focusInt);
      notify({text:"Focus Complete"});
    }
  },1000);
}
function toggleComplete(i){
  todos[i].done = !todos[i].done;
  save();
  render();
}

function stopFocus(){
  clearInterval(focusInt);
  timer.textContent="25:00";
  bar.style.width="0%";
}

if("serviceWorker" in navigator){
  navigator.serviceWorker.register("sw.js");
}
async function enablePush() {
  const permission = await Notification.requestPermission();
  if (permission !== "granted") return alert("Permission denied");

  const token = await messaging.getToken({
    vapidKey: "YOUR_PUBLIC_VAPID_KEY"
  });

  console.log("FCM Token:", token);
  alert("Push notifications enabled!");
}



todos.forEach(schedule);
render();
</script>
</body>
</html>
